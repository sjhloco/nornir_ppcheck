#######! Examples of how to use any of the IOS-XE validations !#######
groups:
  iosxe:
  # ----------------------------------------------------------------------------
  # SWI_RTR: Switch and router commands
  # ----------------------------------------------------------------------------
  ### IMAGE (strict): show version: The current running image. STRICT
    image: 16.6.2
  ### ACL (strict): show ip access-lists <name> - Management type extended ACLs, the protocol protocol is always 'IP' and the destination 'any'. STRICT, so exact match
    acl:
      - name: TEST_SSH_ACCESS
        ace:
          - { remark: MGMT Access - VLAN10 }
          - { permit: 10.17.10.0/24 }
          - { remark: Citrix Access }
          - { permit: 10.10.10.10/32 }
          - { deny: any }
  ### PO (strict): show etherchannel summary - Port-channel, mode, member interfaces and status. STRICT, so exact interfaces
    port_channel:
      Po1:
        protocol: LACP
        members: [Te1/1/1]
      Po101:
        protocol: LACP
        members: [Te1/1/8, Te2/1/8]
  ### INTF_BR: show ip interface brief - L3 interface and IP address, status is expected to be up (only checks for these interfaces)
    intf_brief:
      Vlan800: 10.10.20.102
      GigabitEthernet1: 10.20.20.102
      GigabitEthernet2: 10.30.20.102
  ### CDP: show cdp neighbors - Local interface, the neighbor connected and the remote interface (only checks for these interfaces)
    cdp_nbr:
      Ten 2/1/1:
        nbr_name: LN-6500-VSS01
        nbr_intf: Ten 2/5/15
      Gi0/2:
        nbr_name: Switch02
        nbr_intf: Gi0/3
  ### LLDP: show lldp neighbor - Local interface, the neighbor connected and the remote interface
    lldp_nbr:
      Te2/1/1:
        nbr_name: LN-6500-VSS01
        nbr_intf: Te2/5/15
      Gi2:
        nbr_name: Router01
        nbr_intf: Gi0/1
  ### HSRP: show standby brief - For each HSRP group (id) the priority and state
    hsrp:
      - id: 1
        priority: 140
        state: Active

  # ----------------------------------------------------------------------------
  # SWI: Switch-only commands
  # ----------------------------------------------------------------------------
  ### SW_STK (strict): show switch - Each stacked switch number, priority, role and state
    switch_stack:
      - sw_number: 1
        priority: 15
        role: Active
        state: Ready
      - sw_number: 2
        priority: 1
        role: Member
        state: Ready
      - sw_number: 3
        priority: 14
        role: Standby
        state: Ready
  ### VSS_HA: show  redundancy state | in state - The SSO redundancy state of the local and paired switch
    vss_state:
      my_state: ACTIVE
      peer_state: STANDBY HOT
  ### INTF_STATUS: show interface status - L2 interface, speed, duplex, status and vlan (routed, trunk or VLAN ID)
    intf_status:
      Gi0/0:
        duplex: a-full
        speed: a-100
        status: connected
        vlan: routed
      Gi1/0/4:
        duplex: a-full
        speed: a-1000
        status: connected
        vlan: 74
      Po1:
        duplex: a-full
        speed: a-10G
        status: notconnect
        vlan: trunk
      Po101:
        duplex: a-full
        speed: a-1000
        status: connected
        vlan: trunk
  ### INTF_SWI_PORT: show interfaces switchport - L2 interface mode (access, trunk down) and VLANs (single or list) over that port
    intf_swi_port:
      Gi1/0/4:
        mode: access
        vlan: 74
      Po1:
        mode: trunk
        vlan: [11,12,704,708,901]
  ### VLAN (strict): show vlan brief - VLAN name and list of its interfaces (strict, so all interfaces)
    vlan:
      701:
        name: TEST_VL701
        intf: [Gi1/0/4]
      1:
        name: default
        intf: [Te1/1/2,Te1/1/4,Te1/1/7,Te2/1/2,Te2/1/4,Te2/1/7]
  ### STP_VLAN: show spanning-tree - List of forwarding (FWD) interfaces per VLAN (access and trunk)
    stp_vlan:
      - vlan: 701
        intf: [Po11,Po201,Gi1/0/4]
      - vlan: 20
        intf: [Gi0/3]
  ### MAC_TABLE (strict): show mac address-table count [vlan x] | count dynamic|DYNAMIC - Total (all vlans) and/or number of  dynamic MAC addresses 
    mac_table:
      total_mac: 1100
      52_total_mac: 6
      10_total_mac: 21
  ### AUTH_SESSION (strict): show authentication sessions | count [mab or dot1x ] - {auth_mab: x or auth_dot1z: x} - Total mab and/or dot1x auth sessions 
    auth_session:
      total_mab: 21
      total_dot1x: 22

  # ----------------------------------------------------------------------------
  # RTR: Router-only commands
  # ----------------------------------------------------------------------------
  ### VRF (strict): show vrf - List of member interfaces for each VRF (/ in names can effect strictness)
    vrf:
      BLU: [BD2001,Lo111]
      AMB: [BD2003,Gi0/1, Gi0/2]
      GRY: [BD2006, Vl20]
  ### ROUTE_SUMMARY (strict): show ip route [vrf XXX] summary | in Total - Total subnets, for non-global RT add name of the vrf to the start
  # Is bug a where due to how napalm_validate works 5 would match 15
    route_summary:
      global_subnets: 21
      BLU_subnets: 4
      AMB_subnets: 15
  ### ROUTE: show ip  route - Route and next-hop for all subnets in global routing table including directly connected (interface is next-hop)
    route:
      192.168.111.3/32: 192.168.2.9
      192.168.45.4/32: Loopback111
      192.168.1.14/30: GigabitEthernet0/0/5
      192.168.35.4/32: [192.168.1.2, 192.168.1.10]
  ### VRF_ROUTE: show ip  route vrf XXX - Add name of the vrf to the start of the variable (before _route)
    BLU_route:
      0.0.0.0/0: 192.168.1.11
      192.168.21.21/32: Loopback21
      10.25.0.0/20: 192.168.17.15
      172.12.100.0/24: Vlan710
      10.100.0.0/20: [192.168.12.11, 192.168.12.12] 
  ### OSPF_INTF (strict): show ip ospf interface brief - Strict list of OSPF interfaces with area, cost and state
    ospf_intf:
      - intf: Gi3
        area: 0
        cost: 1
        state: P2P
      - intf: Lo1
        area: 4
        cost: 1
        state: LOOP
      - intf: Gi0/0/0
        area: 4
        cost: 100
        state: P2P
  ### OSPF_NBR (strict): show ip ospf neighbor - Strict list of OSPF neighbors, state is expected top be FULL
    ospf_nbr:
      nbrs: [192.168.1.5, 2.2.2.2, 192.168.2.5]
  ### OSPF_DB (strict): show ip ospf database database-summary | in Total: - Total LSAs of all types in the LSDB
    ospf_lsdb:
      total_lsa: 3
  ### EIGRP_INTF (strict): show ip eigrp interfaces - Strict list of EIGRP enabled interfaces
    eigrp_intf:
      intf: [Gi3, Lo1]
  ### EIGRP_NBR (strict): show ip eigrp neighbors - Strict list of EIGRP neighbors
    eigrp_nbr:
      nbrs: [10.10.10.2, 2.2.2.2]
  ### BGP (strict): show bgp all summary - Strict dictionary of BGP peers and the associated ASN and number of prefixes
    bgp_summary:
      192.168.67.149:
        asn: 65111
        rcv_pfx: 55
      192.168.167.9:
        asn: 65112
        rcv_pfx: 6
  ### NVE_VNI (strict): show nve vni - Strict dictionary of L3VNIs and the associated BDI and VRF, state is expected top be Up
    nve_vni:
      10003010:
        bdi: 3010
        vrf: BLU
      10003012:
        bdi: 3012
        vrf: GRN
  ### NVE_PEERS (strict): show nve vni - Strict dictionary of L3VNIs and their associated peers, state is expected top be UP
    nve_peers:
      10003010:
        peer: 192.168.99.57
      10003012:
        peer: 192.168.99.57
  ### VPN_BRIEF (strict): show crypto session brief - List of VPN peers and the associated interfaces, status is expected top be UA
    vpn:
      - peer: 21.16.9.23
        intf: Tu10
      - peer: 212.1.1.2
        intf: Tu11
